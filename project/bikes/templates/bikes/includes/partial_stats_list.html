{% load buttons %}{% load humanize %}
{% for component in components %}
{% with component.components as items %}
<table class="table table-striped table-hover table-sm mb-5 tbl-js" id="tbl-{{ component.pk }}">
    <thead>
        <tr style="background-color: #deebf6">
            <th colspan="4">
                {{ component.name }} #{{ component.pk }}
            </th>
            <th colspan="2" class="text-right">
                {% url 'bikes:stats_create' bike_slug component.pk as url_create %}
                {% button_create url=url_create label='New Component' tbl=component.pk %}
            </th>
        </tr>
        <tr class="thead-light">
            <th width="20%">Start date</th>
            <th width="20%">End date</th>
            <th width="15%">Price</th>
            <th>Brand</th>
            <th class="text-right" width="10%">Actions</th>
            <th width="15%" class="km pr-1 text-right">km</th>
        </tr>
    </thead>
    <tbody>
        {% for item in items %}
        {% url 'bikes:stats_update' bike_slug item.pk as url_update %}
        {% url 'bikes:stats_delete' bike_slug item.pk as url_delete %}
        <tr id="row_id_{{ item.pk }}" data-pk="{{ item.pk }}" data-url="{{ url_update }}">
            <td>
                {{ item.start_date|date:"Y-m-d" }}
            </td>
            <td >
                {{ item.end_date|date:"Y-m-d" }}
            </td>
            <td >
                {{ item.price|default_if_none:'#' }}
            </td>
            <td >
                {{ item.brand }}
            </td>
            <td class="text-right">
                {% button_edit pk=item.pk url=url_update tbl=component.pk %}
                {% button_delete type='button' pk=item.pk url=url_delete tbl=component.pk %}
            </td>
            <td class="km pr-1 text-right">
                {{ item.km|floatformat:0|intcomma }}
            </td>
        </tr>
        {% endfor %}
    </tbody>
    <tfoot>
        <tr class="text-white" style="background-color: #1e4e79">
            <td colspan="6">
                {% for stat in component.stats %}
                <span class="mr-4">{{ stat.label|title }}: {{ stat.value|floatformat:0|intcomma }} km</span>{% endfor %}
        </tr>
    </tfoot>
</table>
{% endwith %}
{% endfor %}
