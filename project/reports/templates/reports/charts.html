{% extends parent_template|default:"reports/index.html" %}
{% load static %}

{% block chart %}
<script src="https://code.highcharts.com/highcharts.src.js"></script>
<!-- <script src="{% static 'js/grid-light.js' %}"></script> -->

{% endblock chart %}

{% block content %}

<div class='row'>
    <div class='col-'>
        <div id="my-chart" data-url="{% url 'reports:api-data' %}"></div>

        <script>
            $.ajax({
                url: $("#my-chart").attr("data-url"),
                dataType: 'json',
                success: function (data) {
                    console.log(data)
                    Highcharts.chart("my-chart", {
                        chart : { type: 'column'},
                        xAxis: data.first.xAxis,
                        title: data.first.title,

                        yAxis: {
                            min: 0,
                            title: {
                                text: 'Total fruit consumption'
                            },
                        },

                        legend: {
                            align: 'center',
                            // x: -30,
                            verticalAlign: 'top',
                            y: 25,
                            floating: true,
                            borderColor: '#CCC',
                            borderWidth: 1,
                            shadow: false
                        },

                        tooltip: {
                            headerFormat: '<b>{point.x}</b><br/>',
                            pointFormat: '{series.name}: {point.y}<br/>Total: {point.stackTotal}'
                        },

                        plotOptions: {
                            column: {
                                stacking: 'normal',
                            }
                        },

                        series: data.first.series,
                    });
                }
            });
        </script>


    </div>
</div>
{% endblock content %}
