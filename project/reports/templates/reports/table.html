{% extends "category_goals.html" %}
{% load static %}{% load humanize %}{% load filters %}{% load dictionary_row %}


{% block breadcrumb %}{{ block.super }}
    <span class="navbar-text">&raquo;</span><a class="nav-link disabled" href="{% url 'reports:reports_table' year %}">{{ year }}</a>
{% endblock breadcrumb %}


{% block head %}{{ block.super }}
    <script src="{% static 'js/lrStickyHeader.js' %}"></script>
    <style>
        .lr-sticky-header {
            transition: all 0.6s;
        }
        body { min-height:2000px; }
    </style>
{% endblock head %}
    
{% block content %}

<table class="table table-striped table-hover table-md mt-2">
    <thead class="thead-light">
        <tr>
            <th colspan="2" class="text-center">Max T, &#8451;</th>
            <th colspan="2" class="text-center b-left">Min T, &#8451;</th>
            <th colspan="2" class="text-center b-left">Max Ascent, m</th>
            <th colspan="2" class="text-center b-left">Max Speed, km/h</th>
            <th colspan="2" class="text-center b-left">Max Distance, km</th>
        </tr>
        <tr>
            <th class="text-center">Date</th>
            <th class="text-center">Value</th>
            {% for i in i|rjust:4 %}
            <th class="text-center b-left">Date</th>
            <th class="text-center">Value</th>
            {% endfor %}
        </tr>
    </thead>
    <tbody>
        <tr>
            <td class="text-center">{{ stats.max_temperature_date|date:"Y-m-d" }}</td>
            <td class="text-center">{{ stats.max_temperature_value|floatformat:0 }}</td>
            <td class="text-center b-left">{{ stats.min_temperature_date|date:"Y-m-d" }}</td>
            <td class="text-center">{{ stats.min_temperature_value|floatformat:0 }}</td>
            <td class="text-center b-left">{{ stats.max_ascent_date|date:"Y-m-d" }}</td>
            <td class="text-center">{{ stats.max_ascent_value|floatformat:0 }}</td>
            <td class="text-center b-left">{{ stats.max_speed_date|date:"Y-m-d" }}</td>
            <td class="text-center">{{ stats.max_speed_value|floatformat:1 }}</td>
            <td class="text-center b-left">{{ stats.max_distance_date|date:"Y-m-d" }}</td>
            <td class="text-center">{{ stats.max_distance_value|floatformat:1 }}</td>
        </tr>
    </tbody>
</table>


<table class="table table-hover table-striped mt-3">
    <thead class="thead-light">
        <tr>
            <th colspan="3"> </th>
            <th colspan="4" class="text-center b-left">Workout Stats</th>
            <th colspan="5" class="text-center b-left">Month Stats</th>
            <th colspan="5" class="text-center b-left">Season Stats</th>
            <th colspan="3" class="text-center b-left">Goals</th>
        </tr>
        <tr>
            <th>Bike</th>
            <th class="text-center">Date</th>
            <th class="text-right">&#8451;</th>
            <th class="text-center b-left">Dist</th>
            <th class="text-center">Time</th>
            <th class="text-center">Speed</th>
            <th class="text-center">Ascent</th>
            <th class="text-center b-left">Dist</th>
            <th class="text-center">Time</th>
            <th class="text-center">Speed</th>
            <th class="text-center">Per day</th>
            <th class="text-center">Ascent</th>
            <th class="text-center b-left">Dist</th>
            <th class="text-center">Time</th>
            <th class="text-center">Speed</th>
            <th class="text-center">Per day</th>
            <th class="text-center">Ascent</th>
            <th class="text-center b-left">Goal</th>
            <th class="text-center">%</th>
            <th class="text-center">Delta</th>
        </tr>
    </thead>
    <tbody>
        {% for row in objects  %}
        {% ifchanged row.year_month %}<tr>
            {% if not forloop.first %}
            <td colspan="20" class="row-spacer"></td>
            {% endif %}
        </tr>{% endifchanged %}
        <tr>
            <td>{{ row.bike }}</td>
            <td class="text-center">{{ row.date|date:'Y-m-d' }}</td>
            <td class="text-right">{% with row.temperature|floatformat:0 as r %}{% if r != 'nan' %}{{ r }}{% else %}-{% endif %}{% endwith %}</td>
            <td class="text-center b-left">{{ row.distance|floatformat:2 }}</td>
            <td class="text-center">{{ row.sec_workout|duration }}</td>
            <td class="text-center">{{ row.speed_workout|floatformat:1 }}</td>
            <td class="text-center">{{ row.ascent|floatformat:0 }}</td>
            {% ifchanged row.year_month %}{% get_row month row.year_month as m_row %}{% endifchanged %}
            <td class="text-center b-left">{{ m_row.distance|floatformat:0 }}</td>
            <td class="text-center">{{ m_row.sec_workout|duration }}</td>
            <td class="text-center">{{ m_row.speed_month|floatformat:1 }}</td>
            <td class="text-center">{{ m_row.per_day_month|floatformat:1 }}</td>
            <td class="text-center">{{ m_row.ascent|floatformat:0|intcomma }}</td>
            <td class="text-center b-left">{{ row.distance_season|floatformat:0|intcomma }}</td>
            <td class="text-center">{{ row.sec_season|duration }}</td>
            <td class="text-center">{{ row.speed_season|floatformat:1 }}</td>
            <td class="text-center">{{ row.per_day_season|floatformat:1 }}</td>
            <td class="text-center">{{ row.ascent_season|floatformat:0|intcomma }}</td>
            <td class="text-center b-left">{{ row.day_goal|floatformat:0|intcomma }}</td>
            <td class="text-center">{{ row.percent|floatformat:1 }}</td>
            <td class="text-center">{{ row.km_delta|floatformat:0|intcomma }}</td>
        </tr>

        {% endfor %}
    </tbody>
</table>
<script>
    var tables = document.getElementsByTagName('table');
    lrStickyHeader(tables[1]);
</script>
{% endblock content %}
