{% extends "category_charts.html" %}
{% load get_index %}{% load humanize %} 

{% block breadcrumb %}{{ block.super }}
    <span class="navbar-text">&raquo;</span><a class="nav-link disabled" href="{% url 'reports:overall' %}">Owerall</a>
{% endblock breadcrumb %}


{% block content %}

<div class='row'>
    <div class='col-6'>
        <div id="my-chart"></div>

        <script>
            // console.log(data)
            Highcharts.setOptions({
                lang: {
                    thousandsSep: '.',
                    decimalPoint: ',',
                }
            });
            Highcharts.chart("my-chart", {
                chart : { type: 'column'},
                xAxis: {
                    categories: {{ chart.overall.xAxis }},
                },
                margin: 0,
                title: {
                    text: ''
                },
                yAxis: {
                    min: 0,
                    title: {
                        text: 'km, thousants'
                    },
                },
                legend: {
                    align: 'right',
                    verticalAlign: 'middle',
                    shadow: false,
                    reversed: true,
                    layout: 'vertical',
                    itemMarginBottom: 10
                },
                tooltip: {
                    pointFormat: '{point.y:,.0f}',
                    formatter: function () {
                        return '<b>' + this.x + '</b><br/>' +
                            `${this.series.name}: ${Highcharts.numberFormat(this.point.y, 0)}<br/>` +
                            `Total: ${Highcharts.numberFormat(this.point.stackTotal, 0)}`;
                    }
                },
                plotOptions: {
                    column: {
                        stacking: 'normal',
                    }
                },
                series: {{ chart.overall.series|safe }},
            });
        </script>
    </div>

    <div class="col-6"></div>
</div>

<div class="row mt-2">
    <div class="col-6 data-table-px">
        <table class="table table-striped table-hover table-md mt-2">
            <thead class="thead-light">
                <tr>
                    <th>Metai</th>
                    {% for bike in tbody.columns %}<th class="text-right mr-1">{{ bike }}</th>{% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for row in tbody.index %}
                <tr>
                    <td>{{ row }}</td>
                    {% for value in tbody.data|get_index:forloop.counter0 %}
                    <td class="text-right mr-2">{% if value %}{{ value|floatformat:0|intcomma }}{% else %}-{% endif %}</td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>
            <tfoot>
                <th class="text-left">Total</th>
                {% for value in tfooter.data|get_index:0 %}
                <th class="text-right">{{ value|floatformat:0|intcomma }}</th>
                {% endfor %}
            </tfoot>
        </table>
    </div>

    <div class="col-6"></div>
</div>
{% endblock content %}
